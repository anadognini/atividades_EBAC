# -*- coding: utf-8 -*-
"""copie_e_cole_no_excel_usando_o_metodo_to_clipboard().ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1pYLC22q2sZxlzk79Q989qfl20CIsQn5N
"""

import pandas as pd
from sklearn.ensemble import RandomForestClassifier

df = pd.read_csv('/content/dados.csv')
rf = RandomForestClassifier()

cols = [
    'qtd_filhos', 'idade', 'tempo_emprego', 'qt_pessoas_residencia',
    'possui_email', 'possui_fone', 'possui_fone_comercial'
]

rf.fit(df[cols], df['mau'])

print('Feature Importances: ', rf.feature_importances_)
print('Variáveis: ', cols)

(pd.DataFrame({
    'Variável': cols,
    'Feature importances': rf.feature_importances_
})
    .sort_values('Feature importances', ascending=False)
    .style.bar(color=['grey', 'lightblue'], align='zero')
    .format(precision=2)).to_excel('/content/ouput/rf_inadimplencia.xlsx')

(pd.DataFrame({
    'Variável': cols,
    'Feature importances': rf.feature_importances_
})
    .sort_values('Feature importances', ascending=False)).to_clipboard()

"""Observação: `to_clipboard(`) não funciona nem no Google Colab, nem no Kaggle:

"These platforms run Python code on a remote, headless virtual machine in the cloud, which does not have access to your local computer's clipboard for security and technical reasons."
"""